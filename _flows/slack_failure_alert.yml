id: slack_failure_alert
namespace: dev 

tasks:
  - id: send
    type: io.kestra.plugin.notifications.slack.SlackExecution
    url: "{{ secret('SLACK_WEBHOOK') }}"
    channel: "#test"
    customMessage: The flow run_ml_pipeline fails.

triggers:
  - id: listen
    type: io.kestra.core.models.triggers.types.Flow
    conditions:
      - type: io.kestra.core.models.conditions.types.ExecutionFlowCondition
        namespace: io.kestra.tests
        flowId: run_ml_pipeline
      - type: io.kestra.core.models.conditions.types.ExecutionStatusCondition
        in:
          - FAILED